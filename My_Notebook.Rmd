---
title: "My Notebook"
author:
- name: Katia Yang
  email: kaiweny@uchicago.edu
shorttitle: from D2M course
output:   
 bookdown::html_document2:
---

```{r source-script}
source("My_Script.R")

```

<!-- Assignment 5 -->

```{r call-function}
# Call the hello_world function
result1 <- hello_world("Dr.Dowling")
result2 <- hello_world("Voldemort")
result3 <- hello_world("Wubalubadubdub")

# Print the results
print(result1)
print(result2)
print(result3)
```

```{r setup, include = FALSE}
# r package library
library(papaja)
r_refs("r-references.bib")
library(tidyverse)
library(knitr)
library(tinytex)
library(kableExtra)

```

# dataset

# Assignment 10 & 12

```{r male-nouns}
# Data analysis

m.data <- read.csv("//Users/katia/Desktop/D2M/CHILDES_utterance/Childes dataset/Proportion data/noun_proportion_data.csv")

ggplot(m.data, aes(x = target_child_sex, y = mnoun_proportion, fill = target_child_sex)) +
  geom_boxplot(alpha = 0.5) +
  geom_jitter(alpha = 0.5, aes(colour = target_child_sex)) +
  scale_fill_manual(values = c("female" = "lightpink", "male" = "lightblue")) +
  labs(x = "Gender", y = "Proportion", title = "Male-Biased Noun Proportion") +
  theme_minimal()
  
```

X-axis: The gloss variable, representing different words (like "dress", "doll", "necklace", etc.). Y-axis: The count or frequency of each word, indicating how often each word appears in the dataset. Type of Plot: Bar Chart. Comparison Across Groups?: Yes Anticipated Findings: mothers speak more female-biased nouns to female infants than to male infants

As seen in Figure \@ref(fig:my-figure), There's gender bias in the nouns of mother's infant-directed speech.

# Assignment 13. Prettified Plot

```{r my-figure, fig.cap="Proportion of Gender-Biased Nouns by Gender"}
combined.data <- read.csv("//Users/katia/Desktop/D2M/CHILDES_utterance/Childes dataset/Proportion data/noun_proportion_data.csv")

library(tidyr)
long_data <- combined.data %>%
  pivot_longer(cols = c(mnoun_proportion, fnoun_proportion),
               names_to = "type",
               values_to = "proportion")
labels_gender = c('fnoun_proportion' = "Female-Biased", 'mnoun_proportion' = "Male-Biased")

ggplot(long_data, aes(x = target_child_sex, y = proportion, fill = target_child_sex)) +
  geom_boxplot(alpha = 0.5) +
  geom_jitter(alpha = 0.5, aes(colour = target_child_sex)) +
  scale_fill_manual(values = c("female" = "lightpink", "male" = "lightblue")) +
  labs(x = "Gender", y = "Proportion") +
  facet_wrap(~type, scales = "fixed", labeller = as_labeller(labels_gender)) +
  labs(title = "Proportion of Gender-Biased Nouns")+
  theme(
  strip.background = element_rect(fill = "gray60"),
  strip.text = element_text(colour = "white", family = "Courier", hjust = 0),
  legend.position = "bottom"
)
```

X-axis: female/male infants\
Y-axis: counts of frequency of female-biased nouns Type of Plot: box plot\
Comparison Across Groups?: Yes\
Anticipated Findings: mothers speak more female-biased nouns in CDS to female infants than to male infants

# Assignment 14

```{r my-table, tab.cap = "Male-Infant Data"}
knitr::kable(m.data,
                  format = "html", 
                  booktabs = TRUE, 
                  caption = "Male-Infant Data", 
                  label = "my-table") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  column_spec(1, bold = TRUE, color = "blue") %>%
  row_spec(0, bold = TRUE, background = "#D3D3D3")


```

As shown in Table \@ref(tab:my-table), the gender distribution in the dataset varies, with a higher percentage of Female compared to Male.

# Assignment 15 & 16

## *Descriptive Analysis*: Examining Maternal Gender-Biased Language Imput Patterns

```{r descriptive-analysis}
library(psych)
library(lme4)

   ## In this analysis, I aim to describe the patterns of gender-biased language usage by mothers in interactions with their children. The analysis will focus on:
   ### - The frequency of appearance-related adjectives (e.g., "pretty", "beautiful") and competence-related adjectives (e.g., "strong", "smart") used by mothers when speaking to boys vs. girls.
   ### - The frequency of gender-biased nouns (e.g., "truck" for boys, "doll" for girls) used by mothers in their speech to children of different genders.

  ## Independent Variables: Child's gender (binary: male or female)

## Assignment 16.1 *Descriptive Statistics* for male-biased nouns
# Calculate descriptive statistics for male-biased nouns
noun_tidied_count <- read.csv("/Users/katia/Desktop/D2M/CHILDES_utterance/Childes dataset/Proportion data/noun_proportion_number.csv")

summary_mnoun <- noun_tidied_count %>%
  group_by(target_child_sex) %>%
  summarise(mean_mnoun = mean(mnoun_proportion),
            median_mnoun = median(mnoun_proportion),
            sd_mnoun = sd(mnoun_proportion),
            .groups = 'drop')

# Print the summary statistics
print(summary_mnoun)

#Visualization of all stats
library(tidyr)
long_data <- noun_tidied_count %>%
  pivot_longer(cols = c(mnoun_proportion, fnoun_proportion),
               names_to = "type",
               values_to = "proportion")
labels_gender = c('fnoun_proportion' = "Female-Biased", 'mnoun_proportion' = "Male-Biased")

ggplot(long_data, aes(x = target_child_sex, y = proportion, fill = target_child_sex)) +
  geom_boxplot(alpha = 0.5) +
  geom_jitter(alpha = 0.5, aes(colour = target_child_sex)) +
  scale_fill_manual(values = c("female" = "lightpink", "male" = "lightblue")) +
  labs(x = "Gender", y = "Proportion") +
  facet_wrap(~type, scales = "fixed", labeller = as_labeller(labels_gender)) +
  labs(title = "Proportion of Gender-Biased Nouns")+
  theme(
  panel.grid = element_line(colour = "white", linetype = 3),
  legend.title = element_text(size = 10),
  strip.background = element_rect(fill = "gray60"),
  strip.text = element_text(colour = "white", hjust = 0),
  legend.position = "bottom"
)

  ## Dependent Variables:
  ### - Percentage of gender-biased adjectives (appearance-related and competence-related) in maternal language input.
  ### - Percentage of gender-biased nouns in maternal language input.
 
  ## This descriptive analysis will involve calculating means and standard deviations for the usage of gender-biased language across mothers of boys and girls. We will visualize these patterns through box and jitter plots to identify any apparent differences in language input based on the child's gender.
```

## *Hypothesis Testing Analysis*: Testing the Influence of Child's Gender on Maternal Language Input

```{r hypothesis-analysis}
library(stats)
noun_tidied_count <- read.csv("/Users/katia/Desktop/D2M/CHILDES_utterance/Childes dataset/Proportion data/noun_proportion_number.csv")
# ANOVA for male-biased nouns
anova_mnoun <- aov(mnoun_proportion ~ target_child_sex, data = noun_tidied_count)
summary(anova_mnoun)

# ANOVA for female-biased nouns
anova_fnoun <- aov(fnoun_proportion ~ target_child_sex, data = noun_tidied_count)
# Get the summary of the ANOVA result
summary(anova_fnoun)
tukey_results <- TukeyHSD(anova_fnoun)

  ## Hypothesized Results: It is hypothesized that there will be a significant difference in the percentage of gender-biased language (both adjectives and nouns) used by mothers, with a higher use of appearance-related words for girls and competence-related words for boys, as well as a higher usage of gender-congruent nouns (male-biased with boys, female-biased with girls).
  
  ## Appropriate Tests: For comparing multiple variables between two groups (boys vs. girls), *ANOVA* could be appropriate for continuous data (e.g., percentage of gender-biased words). 

  ### This analysis will help determine if there is a statistically significant difference in maternal language input that could contribute to the early formation of gender stereotypes and expectations in children.

```
# Assignment 17

The ANOVA tests conducted on the proportions of female-biased nouns used by mothers reveal the following: 
The Tukey test results are: 
`r knitr::kable(tukey_results$target_child_sex, caption = "Tukey HSD Test Results for Target Child Sex")`

For female-biased nouns used by mothers, the F-statistic is $F$ = `r round(summary(anova_fnoun)[[1]]$F[1],3)`, $p$ = `r round(summary(anova_fnoun)[[1]]$P[1],3)`.


And for male-biased nouns used by mothers, the F-statistic is $F$ = `r round(summary(anova_mnoun)[[1]]$F[1],3)`, $p$ = `r round(summary(anova_mnoun)[[1]]$P[1],3)`.

The results suggest that there is a statistically significant difference in the usage of gender-biased nouns by mothers when speaking to male children compared to female children, at the conventional 0.05 significance level.

